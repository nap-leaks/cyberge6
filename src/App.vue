<template>
  <div id="app">
    <vue100vh :css="{height: '100rvh'}" class="inobounce">
      <video id="camera" v-if="lsdActive && cameraExists" ref="camera" autoplay playsinline></video>
      <CyberGe6 ref="cyberge6" v-if="appStarted" :left="left" :top="top" :angle="angle" :fire="fire" @stats="onStats" />
      <div class="border left"></div>
      <div class="border top"></div>
      <div class="border right"></div>
      <div class="border bottom"></div>
      <div class="console">
        <div class="left">
          <span>Чукундури: {{stats.total}}</span>
          <br />
          <span class="green">Пръскачки: {{stats.killed}}</span>
          <br />
          <span class="red">КиберGe6: {{stats.survived}}</span>
        </div>
        <div class="right" v-if="lsdActive">
          x: {{Math.round(deviceOrientationData.alpha)}} : t: {{Math.round(top)}}
          <br />
          y: {{Math.round(deviceOrientationData.beta)}} : l: {{Math.round(left)}}
          <br />
          z: {{Math.round(deviceOrientationData.gamma)}} : a: {{Math.round(angle)}}
        </div>
        <div class="right" v-else>
          <div class="clock" ref="countdown" v-if="appStarted">
            {{countdown}}
          </div>
          <div v-else>
            <img class="logo" src="./assets/ge6.png" alt="КиберGe6" >
          </div>
        </div>
      </div>
      <div class="laser" ref="laser"></div>
      <div id="crosshair" v-if="appStarted && !lsdActive">
        <svg viewBox="0 0 474.27 474.27">
          <path
            d="M237.135,474.27c130.968,0,237.135-106.167,237.135-237.135S368.103,0,237.135,0
            S0,106.167,0,237.135S106.167,474.27,237.135,474.27z M60.639,200.556C75.197,130.212,130.87,74.742,201.32,60.485v65.557h73.157
            V60.81c69.727,14.753,124.7,69.914,139.161,139.746h-66.167v73.157h66.167c-14.453,69.833-69.434,124.993-139.161,139.746v-65.232
            H201.32v65.557c-70.45-14.266-126.123-69.727-140.681-140.072h66.167v-73.157H60.639z"
          />
          <circle cx="239.842" cy="237.135" r="18.964" />
        </svg>
      </div>
      <button
        v-if="appStarted && cameraExists"
        class="lsd"
        ref="btnLSD"
      >
        <svg v-if="lsdActive" height="480pt" viewBox="0 0 480 480" width="480pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><linearGradient id="a"><stop offset="0" stop-color="#4761ac"/><stop offset="1" stop-color="#54c2ef"/></linearGradient><linearGradient id="b" gradientUnits="userSpaceOnUse" x1="-16" x2="475.2" xlink:href="#a" y1="240" y2="240"/><linearGradient id="c" gradientUnits="userSpaceOnUse" x1="-16" x2="475.2" xlink:href="#a" y1="284" y2="284"/><linearGradient id="d" gradientUnits="userSpaceOnUse" x1="-16" x2="475.2" xlink:href="#a" y1="200" y2="200"/><linearGradient id="e" gradientUnits="userSpaceOnUse" x1="-16" x2="475.2" xlink:href="#a" y1="72" y2="72"/><linearGradient id="f" gradientUnits="userSpaceOnUse" x1="-16" x2="475.2" xlink:href="#a" y1="104" y2="104"/><linearGradient id="g" gradientUnits="userSpaceOnUse" x1="-16" x2="475.2" xlink:href="#a" y1="376" y2="376"/><linearGradient id="h" gradientUnits="userSpaceOnUse" x1="-16" x2="475.2" xlink:href="#a" y1="408" y2="408"/><path d="m472 0h-56c-4.417969 0-8 3.582031-8 8 0 13.253906-10.746094 24-24 24s-24-10.746094-24-24c0-4.417969-3.582031-8-8-8h-32c-4.417969 0-8 3.582031-8 8 0 13.253906-10.746094 24-24 24s-24-10.746094-24-24c0-4.417969-3.582031-8-8-8h-32c-4.417969 0-8 3.582031-8 8 0 13.253906-10.746094 24-24 24s-24-10.746094-24-24c0-4.417969-3.582031-8-8-8h-32c-4.417969 0-8 3.582031-8 8 0 13.253906-10.746094 24-24 24s-24-10.746094-24-24c0-4.417969-3.582031-8-8-8h-56c-4.417969 0-8 3.582031-8 8v56c0 4.417969 3.582031 8 8 8 13.253906 0 24 10.746094 24 24s-10.746094 24-24 24c-4.417969 0-8 3.582031-8 8v32c0 4.417969 3.582031 8 8 8 13.253906 0 24 10.746094 24 24s-10.746094 24-24 24c-4.417969 0-8 3.582031-8 8v32c0 4.417969 3.582031 8 8 8 13.253906 0 24 10.746094 24 24s-10.746094 24-24 24c-4.417969 0-8 3.582031-8 8v32c0 4.417969 3.582031 8 8 8 13.253906 0 24 10.746094 24 24s-10.746094 24-24 24c-4.417969 0-8 3.582031-8 8v56c0 4.417969 3.582031 8 8 8h56c4.417969 0 8-3.582031 8-8 0-13.253906 10.746094-24 24-24s24 10.746094 24 24c0 4.417969 3.582031 8 8 8h32c4.417969 0 8-3.582031 8-8 0-13.253906 10.746094-24 24-24s24 10.746094 24 24c0 4.417969 3.582031 8 8 8h32c4.417969 0 8-3.582031 8-8 0-13.253906 10.746094-24 24-24s24 10.746094 24 24c0 4.417969 3.582031 8 8 8h32c4.417969 0 8-3.582031 8-8 0-13.253906 10.746094-24 24-24s24 10.746094 24 24c0 4.417969 3.582031 8 8 8h56c4.417969 0 8-3.582031 8-8v-56c0-4.417969-3.582031-8-8-8-13.253906 0-24-10.746094-24-24s10.746094-24 24-24c4.417969 0 8-3.582031 8-8v-32c0-4.417969-3.582031-8-8-8-13.253906 0-24-10.746094-24-24s10.746094-24 24-24c4.417969 0 8-3.582031 8-8v-32c0-4.417969-3.582031-8-8-8-13.253906 0-24-10.746094-24-24s10.746094-24 24-24c4.417969 0 8-3.582031 8-8v-32c0-4.417969-3.582031-8-8-8-13.253906 0-24-10.746094-24-24s10.746094-24 24-24c4.417969 0 8-3.582031 8-8v-56c0-4.417969-3.582031-8-8-8zm-8 56.800781c-18.644531 3.785157-32.039062 20.175781-32.039062 39.199219s13.394531 35.414062 32.039062 39.199219v17.601562c-18.644531 3.785157-32.039062 20.175781-32.039062 39.199219s13.394531 35.414062 32.039062 39.199219v17.601562c-18.644531 3.785157-32.039062 20.175781-32.039062 39.199219s13.394531 35.414062 32.039062 39.199219v17.601562c-18.644531 3.785157-32.039062 20.175781-32.039062 39.199219s13.394531 35.414062 32.039062 39.199219v40.800781h-40.800781c-3.785157-18.644531-20.175781-32.039062-39.199219-32.039062s-35.414062 13.394531-39.199219 32.039062h-17.601562c-3.785157-18.644531-20.175781-32.039062-39.199219-32.039062s-35.414062 13.394531-39.199219 32.039062h-17.601562c-3.785157-18.644531-20.175781-32.039062-39.199219-32.039062s-35.414062 13.394531-39.199219 32.039062h-17.601562c-3.785157-18.644531-20.175781-32.039062-39.199219-32.039062s-35.414062 13.394531-39.199219 32.039062h-40.800781v-40.800781c18.644531-3.785157 32.039062-20.175781 32.039062-39.199219s-13.394531-35.414062-32.039062-39.199219v-17.601562c18.644531-3.785157 32.039062-20.175781 32.039062-39.199219s-13.394531-35.414062-32.039062-39.199219v-17.601562c18.644531-3.785157 32.039062-20.175781 32.039062-39.199219s-13.394531-35.414062-32.039062-39.199219v-17.601562c18.644531-3.785157 32.039062-20.175781 32.039062-39.199219s-13.394531-35.414062-32.039062-39.199219v-40.800781h40.800781c3.785157 18.644531 20.175781 32.039062 39.199219 32.039062s35.414062-13.394531 39.199219-32.039062h17.601562c3.785157 18.644531 20.175781 32.039062 39.199219 32.039062s35.414062-13.394531 39.199219-32.039062h17.601562c3.785157 18.644531 20.175781 32.039062 39.199219 32.039062s35.414062-13.394531 39.199219-32.039062h17.601562c3.785157 18.644531 20.175781 32.039062 39.199219 32.039062s35.414062-13.394531 39.199219-32.039062h40.800781zm0 0" fill="url(#b)"/><path d="m240 80c-88.367188 0-160 71.632812-160 160s71.632812 160 160 160 160-71.632812 160-160c-.101562-88.324219-71.675781-159.898438-160-160zm0 304c-79.527344 0-144-64.472656-144-144s64.472656-144 144-144 144 64.472656 144 144c-.09375 79.492188-64.507812 143.90625-144 144zm0 0" fill="url(#b)"/><path d="m336.726562 232c-2.109374-.210938-4.214843.433594-5.847656 1.785156-1.632812 1.355469-2.660156 3.304688-2.847656 5.414063-.296875 3.367187-8.253906 80.800781-88.03125 80.800781-79.472656 0-87.71875-77.449219-88-80.742188-.40625-4.421874-4.316406-7.671874-8.734375-7.265624s-7.671875 4.316406-7.265625 8.734374c.121094.953126 9.785156 95.273438 104 95.273438s103.878906-94.320312 104-95.273438c.203125-2.121093-.453125-4.238281-1.816406-5.878906-1.367188-1.636718-3.332032-2.664062-5.457032-2.847656zm0 0" fill="url(#c)"/><path d="m200 232c17.671875 0 32-14.328125 32-32s-14.328125-32-32-32-32 14.328125-32 32 14.328125 32 32 32zm0-48c8.835938 0 16 7.164062 16 16s-7.164062 16-16 16-16-7.164062-16-16 7.164062-16 16-16zm0 0" fill="url(#d)"/><path d="m280 232c17.671875 0 32-14.328125 32-32s-14.328125-32-32-32-32 14.328125-32 32 14.328125 32 32 32zm0-48c8.835938 0 16 7.164062 16 16s-7.164062 16-16 16-16-7.164062-16-16 7.164062-16 16-16zm0 0" fill="url(#d)"/><path d="m96 80c4.417969 0 8-3.582031 8-8s-3.582031-8-8-8h-16c-4.417969 0-8 3.582031-8 8s3.582031 8 8 8zm0 0" fill="url(#e)"/><path d="m96 104c0 4.417969 3.582031 8 8 8h8c4.417969 0 8-3.582031 8-8s-3.582031-8-8-8h-8c-4.417969 0-8 3.582031-8 8zm0 0" fill="url(#f)"/><path d="m392 376c0-4.417969-3.582031-8-8-8h-16c-4.417969 0-8 3.582031-8 8s3.582031 8 8 8h16c4.417969 0 8-3.582031 8-8zm0 0" fill="url(#g)"/><path d="m408 400h-16c-4.417969 0-8 3.582031-8 8s3.582031 8 8 8h16c4.417969 0 8-3.582031 8-8s-3.582031-8-8-8zm0 0" fill="url(#h)"/></svg>
        <svg v-if="!lsdActive" height="480pt" viewBox="0 0 480 480" width="480pt" xmlns="http://www.w3.org/2000/svg"><path d="m440 384c0-17.671875 14.328125-32 32-32v-32c-17.671875 0-32-14.328125-32-32s14.328125-32 32-32v-32c-17.671875 0-32-14.328125-32-32s14.328125-32 32-32v-32c-17.671875 0-32-14.328125-32-32s14.328125-32 32-32v-56h-56c0 17.671875-14.328125 32-32 32s-32-14.328125-32-32h-32c0 17.671875-14.328125 32-32 32s-32-14.328125-32-32h-32c0 17.671875-14.328125 32-32 32s-32-14.328125-32-32h-32c0 17.671875-14.328125 32-32 32s-32-14.328125-32-32h-56v56c17.671875 0 32 14.328125 32 32s-14.328125 32-32 32v32c17.671875 0 32 14.328125 32 32s-14.328125 32-32 32v32c17.671875 0 32 14.328125 32 32s-14.328125 32-32 32v32c17.671875 0 32 14.328125 32 32s-14.328125 32-32 32v56h56c0-17.671875 14.328125-32 32-32s32 14.328125 32 32h32c0-17.671875 14.328125-32 32-32s32 14.328125 32 32h32c0-17.671875 14.328125-32 32-32s32 14.328125 32 32h32c0-17.671875 14.328125-32 32-32s32 14.328125 32 32h56v-56c-17.671875 0-32-14.328125-32-32zm0 0" fill="#dc93bf"/><path d="m392 240c0 83.949219-68.050781 152-152 152s-152-68.050781-152-152 68.050781-152 152-152 152 68.050781 152 152zm0 0" fill="#db527d"/><path d="m336.726562 232c-2.109374-.210938-4.214843.433594-5.847656 1.785156-1.632812 1.355469-2.660156 3.304688-2.847656 5.414063-.296875 3.367187-8.253906 80.800781-88.03125 80.800781-79.472656 0-87.71875-77.449219-88-80.742188-.40625-4.421874-4.316406-7.671874-8.734375-7.265624s-7.671875 4.316406-7.265625 8.734374c.121094.953126 9.785156 95.273438 104 95.273438s103.878906-94.320312 104-95.273438c.203125-2.121093-.453125-4.238281-1.816406-5.878906-1.367188-1.636718-3.332032-2.664062-5.457032-2.847656zm0 0" fill="#f98c96"/><path d="m224 200c0 13.253906-10.746094 24-24 24s-24-10.746094-24-24 10.746094-24 24-24 24 10.746094 24 24zm0 0" fill="#f98c96"/><path d="m304 200c0 13.253906-10.746094 24-24 24s-24-10.746094-24-24 10.746094-24 24-24 24 10.746094 24 24zm0 0" fill="#f98c96"/><g fill="#fff"><path d="m96 80h-16c-4.417969 0-8-3.582031-8-8s3.582031-8 8-8h16c4.417969 0 8 3.582031 8 8s-3.582031 8-8 8zm0 0"/><path d="m112 112h-8c-4.417969 0-8-3.582031-8-8s3.582031-8 8-8h8c4.417969 0 8 3.582031 8 8s-3.582031 8-8 8zm0 0"/><path d="m384 384h-16c-4.417969 0-8-3.582031-8-8s3.582031-8 8-8h16c4.417969 0 8 3.582031 8 8s-3.582031 8-8 8zm0 0"/><path d="m408 416h-16c-4.417969 0-8-3.582031-8-8s3.582031-8 8-8h16c4.417969 0 8 3.582031 8 8s-3.582031 8-8 8zm0 0"/></g><path d="m472 0h-56c-4.417969 0-8 3.582031-8 8 0 13.253906-10.746094 24-24 24s-24-10.746094-24-24c0-4.417969-3.582031-8-8-8h-32c-4.417969 0-8 3.582031-8 8 0 13.253906-10.746094 24-24 24s-24-10.746094-24-24c0-4.417969-3.582031-8-8-8h-32c-4.417969 0-8 3.582031-8 8 0 13.253906-10.746094 24-24 24s-24-10.746094-24-24c0-4.417969-3.582031-8-8-8h-32c-4.417969 0-8 3.582031-8 8 0 13.253906-10.746094 24-24 24s-24-10.746094-24-24c0-4.417969-3.582031-8-8-8h-56c-4.417969 0-8 3.582031-8 8v56c0 4.417969 3.582031 8 8 8 13.253906 0 24 10.746094 24 24s-10.746094 24-24 24c-4.417969 0-8 3.582031-8 8v32c0 4.417969 3.582031 8 8 8 13.253906 0 24 10.746094 24 24s-10.746094 24-24 24c-4.417969 0-8 3.582031-8 8v32c0 4.417969 3.582031 8 8 8 13.253906 0 24 10.746094 24 24s-10.746094 24-24 24c-4.417969 0-8 3.582031-8 8v32c0 4.417969 3.582031 8 8 8 13.253906 0 24 10.746094 24 24s-10.746094 24-24 24c-4.417969 0-8 3.582031-8 8v56c0 4.417969 3.582031 8 8 8h56c4.417969 0 8-3.582031 8-8 0-13.253906 10.746094-24 24-24s24 10.746094 24 24c0 4.417969 3.582031 8 8 8h32c4.417969 0 8-3.582031 8-8 0-13.253906 10.746094-24 24-24s24 10.746094 24 24c0 4.417969 3.582031 8 8 8h32c4.417969 0 8-3.582031 8-8 0-13.253906 10.746094-24 24-24s24 10.746094 24 24c0 4.417969 3.582031 8 8 8h32c4.417969 0 8-3.582031 8-8 0-13.253906 10.746094-24 24-24s24 10.746094 24 24c0 4.417969 3.582031 8 8 8h56c4.417969 0 8-3.582031 8-8v-56c0-4.417969-3.582031-8-8-8-13.253906 0-24-10.746094-24-24s10.746094-24 24-24c4.417969 0 8-3.582031 8-8v-32c0-4.417969-3.582031-8-8-8-13.253906 0-24-10.746094-24-24s10.746094-24 24-24c4.417969 0 8-3.582031 8-8v-32c0-4.417969-3.582031-8-8-8-13.253906 0-24-10.746094-24-24s10.746094-24 24-24c4.417969 0 8-3.582031 8-8v-32c0-4.417969-3.582031-8-8-8-13.253906 0-24-10.746094-24-24s10.746094-24 24-24c4.417969 0 8-3.582031 8-8v-56c0-4.417969-3.582031-8-8-8zm-8 56.800781c-18.644531 3.785157-32.039062 20.175781-32.039062 39.199219s13.394531 35.414062 32.039062 39.199219v17.601562c-18.644531 3.785157-32.039062 20.175781-32.039062 39.199219s13.394531 35.414062 32.039062 39.199219v17.601562c-18.644531 3.785157-32.039062 20.175781-32.039062 39.199219s13.394531 35.414062 32.039062 39.199219v17.601562c-18.644531 3.785157-32.039062 20.175781-32.039062 39.199219s13.394531 35.414062 32.039062 39.199219v40.800781h-40.800781c-3.785157-18.644531-20.175781-32.039062-39.199219-32.039062s-35.414062 13.394531-39.199219 32.039062h-17.601562c-3.785157-18.644531-20.175781-32.039062-39.199219-32.039062s-35.414062 13.394531-39.199219 32.039062h-17.601562c-3.785157-18.644531-20.175781-32.039062-39.199219-32.039062s-35.414062 13.394531-39.199219 32.039062h-17.601562c-3.785157-18.644531-20.175781-32.039062-39.199219-32.039062s-35.414062 13.394531-39.199219 32.039062h-40.800781v-40.800781c18.644531-3.785157 32.039062-20.175781 32.039062-39.199219s-13.394531-35.414062-32.039062-39.199219v-17.601562c18.644531-3.785157 32.039062-20.175781 32.039062-39.199219s-13.394531-35.414062-32.039062-39.199219v-17.601562c18.644531-3.785157 32.039062-20.175781 32.039062-39.199219s-13.394531-35.414062-32.039062-39.199219v-17.601562c18.644531-3.785157 32.039062-20.175781 32.039062-39.199219s-13.394531-35.414062-32.039062-39.199219v-40.800781h40.800781c3.785157 18.644531 20.175781 32.039062 39.199219 32.039062s35.414062-13.394531 39.199219-32.039062h17.601562c3.785157 18.644531 20.175781 32.039062 39.199219 32.039062s35.414062-13.394531 39.199219-32.039062h17.601562c3.785157 18.644531 20.175781 32.039062 39.199219 32.039062s35.414062-13.394531 39.199219-32.039062h17.601562c3.785157 18.644531 20.175781 32.039062 39.199219 32.039062s35.414062-13.394531 39.199219-32.039062h40.800781zm0 0"/><path d="m240 80c-88.367188 0-160 71.632812-160 160s71.632812 160 160 160 160-71.632812 160-160c-.101562-88.324219-71.675781-159.898438-160-160zm0 304c-79.527344 0-144-64.472656-144-144s64.472656-144 144-144 144 64.472656 144 144c-.09375 79.492188-64.507812 143.90625-144 144zm0 0"/><path d="m336.726562 232c-2.109374-.210938-4.214843.433594-5.847656 1.785156-1.632812 1.355469-2.660156 3.304688-2.847656 5.414063-.296875 3.367187-8.253906 80.800781-88.03125 80.800781-79.472656 0-87.71875-77.449219-88-80.742188-.40625-4.421874-4.316406-7.671874-8.734375-7.265624s-7.671875 4.316406-7.265625 8.734374c.121094.953126 9.785156 95.273438 104 95.273438s103.878906-94.320312 104-95.273438c.203125-2.121093-.453125-4.238281-1.816406-5.878906-1.367188-1.636718-3.332032-2.664062-5.457032-2.847656zm0 0"/><path d="m200 232c17.671875 0 32-14.328125 32-32s-14.328125-32-32-32-32 14.328125-32 32 14.328125 32 32 32zm0-48c8.835938 0 16 7.164062 16 16s-7.164062 16-16 16-16-7.164062-16-16 7.164062-16 16-16zm0 0"/><path d="m280 232c17.671875 0 32-14.328125 32-32s-14.328125-32-32-32-32 14.328125-32 32 14.328125 32 32 32zm0-48c8.835938 0 16 7.164062 16 16s-7.164062 16-16 16-16-7.164062-16-16 7.164062-16 16-16zm0 0"/><path d="m96 80c4.417969 0 8-3.582031 8-8s-3.582031-8-8-8h-16c-4.417969 0-8 3.582031-8 8s3.582031 8 8 8zm0 0"/><path d="m96 104c0 4.417969 3.582031 8 8 8h8c4.417969 0 8-3.582031 8-8s-3.582031-8-8-8h-8c-4.417969 0-8 3.582031-8 8zm0 0"/><path d="m392 376c0-4.417969-3.582031-8-8-8h-16c-4.417969 0-8 3.582031-8 8s3.582031 8 8 8h16c4.417969 0 8-3.582031 8-8zm0 0"/><path d="m408 400h-16c-4.417969 0-8 3.582031-8 8s3.582031 8 8 8h16c4.417969 0 8-3.582031 8-8s-3.582031-8-8-8zm0 0"/></svg>
      </button>
      <button class="itcard" ref="btnFire">
        <img src="./assets/itcard.png" alt="it-card" />
      </button>
      <div id="info" v-if="!appStarted">
        <img v-if="!appStarted && !appEnded" class="info-logo" src="./assets/howtoplay.png" alt="КиберGe6" />
        <span v-if="!appStarted && !appEnded" ref="txtInfo">Кибер-чукундур е превзел градината. Бялата хакерка Жени-пръскачката е на мисия. С малкият си компютър се опитва да хакне сложни пръскачки, с които да изгони Кибер-чукундура от градината си, веднъж завинаги!
        Не стой просто така, помогни на Жени-пръскачката с твоят 5G ITcard-лазерен меч, да се избави от Кибер-чукундура, преди да е твърде късно и да стане международен скандал!</span>
        <button
          v-if="!appStarted"
          class="itcard"
          @click="onBegin"
        >
          <img src="./assets/itcard.png" alt="it-card" />
        </button>
        <div v-if="!appStarted && appEnded">
          <div v-if="isWinner">
            <h2>Ура!</h2>
            <svg class="end-info" height="480pt" viewBox="0 0 480 480" width="480pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><linearGradient id="a"><stop offset="0" stop-color="#4761ac"/><stop offset="1" stop-color="#54c2ef"/></linearGradient><linearGradient id="b" gradientUnits="userSpaceOnUse" x1="-16" x2="475.2" xlink:href="#a" y1="240" y2="240"/><linearGradient id="c" gradientUnits="userSpaceOnUse" x1="-16" x2="475.2" xlink:href="#a" y1="284" y2="284"/><linearGradient id="d" gradientUnits="userSpaceOnUse" x1="-16" x2="475.2" xlink:href="#a" y1="200" y2="200"/><linearGradient id="e" gradientUnits="userSpaceOnUse" x1="-16" x2="475.2" xlink:href="#a" y1="72" y2="72"/><linearGradient id="f" gradientUnits="userSpaceOnUse" x1="-16" x2="475.2" xlink:href="#a" y1="104" y2="104"/><linearGradient id="g" gradientUnits="userSpaceOnUse" x1="-16" x2="475.2" xlink:href="#a" y1="376" y2="376"/><linearGradient id="h" gradientUnits="userSpaceOnUse" x1="-16" x2="475.2" xlink:href="#a" y1="408" y2="408"/><path d="m472 0h-56c-4.417969 0-8 3.582031-8 8 0 13.253906-10.746094 24-24 24s-24-10.746094-24-24c0-4.417969-3.582031-8-8-8h-32c-4.417969 0-8 3.582031-8 8 0 13.253906-10.746094 24-24 24s-24-10.746094-24-24c0-4.417969-3.582031-8-8-8h-32c-4.417969 0-8 3.582031-8 8 0 13.253906-10.746094 24-24 24s-24-10.746094-24-24c0-4.417969-3.582031-8-8-8h-32c-4.417969 0-8 3.582031-8 8 0 13.253906-10.746094 24-24 24s-24-10.746094-24-24c0-4.417969-3.582031-8-8-8h-56c-4.417969 0-8 3.582031-8 8v56c0 4.417969 3.582031 8 8 8 13.253906 0 24 10.746094 24 24s-10.746094 24-24 24c-4.417969 0-8 3.582031-8 8v32c0 4.417969 3.582031 8 8 8 13.253906 0 24 10.746094 24 24s-10.746094 24-24 24c-4.417969 0-8 3.582031-8 8v32c0 4.417969 3.582031 8 8 8 13.253906 0 24 10.746094 24 24s-10.746094 24-24 24c-4.417969 0-8 3.582031-8 8v32c0 4.417969 3.582031 8 8 8 13.253906 0 24 10.746094 24 24s-10.746094 24-24 24c-4.417969 0-8 3.582031-8 8v56c0 4.417969 3.582031 8 8 8h56c4.417969 0 8-3.582031 8-8 0-13.253906 10.746094-24 24-24s24 10.746094 24 24c0 4.417969 3.582031 8 8 8h32c4.417969 0 8-3.582031 8-8 0-13.253906 10.746094-24 24-24s24 10.746094 24 24c0 4.417969 3.582031 8 8 8h32c4.417969 0 8-3.582031 8-8 0-13.253906 10.746094-24 24-24s24 10.746094 24 24c0 4.417969 3.582031 8 8 8h32c4.417969 0 8-3.582031 8-8 0-13.253906 10.746094-24 24-24s24 10.746094 24 24c0 4.417969 3.582031 8 8 8h56c4.417969 0 8-3.582031 8-8v-56c0-4.417969-3.582031-8-8-8-13.253906 0-24-10.746094-24-24s10.746094-24 24-24c4.417969 0 8-3.582031 8-8v-32c0-4.417969-3.582031-8-8-8-13.253906 0-24-10.746094-24-24s10.746094-24 24-24c4.417969 0 8-3.582031 8-8v-32c0-4.417969-3.582031-8-8-8-13.253906 0-24-10.746094-24-24s10.746094-24 24-24c4.417969 0 8-3.582031 8-8v-32c0-4.417969-3.582031-8-8-8-13.253906 0-24-10.746094-24-24s10.746094-24 24-24c4.417969 0 8-3.582031 8-8v-56c0-4.417969-3.582031-8-8-8zm-8 56.800781c-18.644531 3.785157-32.039062 20.175781-32.039062 39.199219s13.394531 35.414062 32.039062 39.199219v17.601562c-18.644531 3.785157-32.039062 20.175781-32.039062 39.199219s13.394531 35.414062 32.039062 39.199219v17.601562c-18.644531 3.785157-32.039062 20.175781-32.039062 39.199219s13.394531 35.414062 32.039062 39.199219v17.601562c-18.644531 3.785157-32.039062 20.175781-32.039062 39.199219s13.394531 35.414062 32.039062 39.199219v40.800781h-40.800781c-3.785157-18.644531-20.175781-32.039062-39.199219-32.039062s-35.414062 13.394531-39.199219 32.039062h-17.601562c-3.785157-18.644531-20.175781-32.039062-39.199219-32.039062s-35.414062 13.394531-39.199219 32.039062h-17.601562c-3.785157-18.644531-20.175781-32.039062-39.199219-32.039062s-35.414062 13.394531-39.199219 32.039062h-17.601562c-3.785157-18.644531-20.175781-32.039062-39.199219-32.039062s-35.414062 13.394531-39.199219 32.039062h-40.800781v-40.800781c18.644531-3.785157 32.039062-20.175781 32.039062-39.199219s-13.394531-35.414062-32.039062-39.199219v-17.601562c18.644531-3.785157 32.039062-20.175781 32.039062-39.199219s-13.394531-35.414062-32.039062-39.199219v-17.601562c18.644531-3.785157 32.039062-20.175781 32.039062-39.199219s-13.394531-35.414062-32.039062-39.199219v-17.601562c18.644531-3.785157 32.039062-20.175781 32.039062-39.199219s-13.394531-35.414062-32.039062-39.199219v-40.800781h40.800781c3.785157 18.644531 20.175781 32.039062 39.199219 32.039062s35.414062-13.394531 39.199219-32.039062h17.601562c3.785157 18.644531 20.175781 32.039062 39.199219 32.039062s35.414062-13.394531 39.199219-32.039062h17.601562c3.785157 18.644531 20.175781 32.039062 39.199219 32.039062s35.414062-13.394531 39.199219-32.039062h17.601562c3.785157 18.644531 20.175781 32.039062 39.199219 32.039062s35.414062-13.394531 39.199219-32.039062h40.800781zm0 0" fill="url(#b)"/><path d="m240 80c-88.367188 0-160 71.632812-160 160s71.632812 160 160 160 160-71.632812 160-160c-.101562-88.324219-71.675781-159.898438-160-160zm0 304c-79.527344 0-144-64.472656-144-144s64.472656-144 144-144 144 64.472656 144 144c-.09375 79.492188-64.507812 143.90625-144 144zm0 0" fill="url(#b)"/><path d="m336.726562 232c-2.109374-.210938-4.214843.433594-5.847656 1.785156-1.632812 1.355469-2.660156 3.304688-2.847656 5.414063-.296875 3.367187-8.253906 80.800781-88.03125 80.800781-79.472656 0-87.71875-77.449219-88-80.742188-.40625-4.421874-4.316406-7.671874-8.734375-7.265624s-7.671875 4.316406-7.265625 8.734374c.121094.953126 9.785156 95.273438 104 95.273438s103.878906-94.320312 104-95.273438c.203125-2.121093-.453125-4.238281-1.816406-5.878906-1.367188-1.636718-3.332032-2.664062-5.457032-2.847656zm0 0" fill="url(#c)"/><path d="m200 232c17.671875 0 32-14.328125 32-32s-14.328125-32-32-32-32 14.328125-32 32 14.328125 32 32 32zm0-48c8.835938 0 16 7.164062 16 16s-7.164062 16-16 16-16-7.164062-16-16 7.164062-16 16-16zm0 0" fill="url(#d)"/><path d="m280 232c17.671875 0 32-14.328125 32-32s-14.328125-32-32-32-32 14.328125-32 32 14.328125 32 32 32zm0-48c8.835938 0 16 7.164062 16 16s-7.164062 16-16 16-16-7.164062-16-16 7.164062-16 16-16zm0 0" fill="url(#d)"/><path d="m96 80c4.417969 0 8-3.582031 8-8s-3.582031-8-8-8h-16c-4.417969 0-8 3.582031-8 8s3.582031 8 8 8zm0 0" fill="url(#e)"/><path d="m96 104c0 4.417969 3.582031 8 8 8h8c4.417969 0 8-3.582031 8-8s-3.582031-8-8-8h-8c-4.417969 0-8 3.582031-8 8zm0 0" fill="url(#f)"/><path d="m392 376c0-4.417969-3.582031-8-8-8h-16c-4.417969 0-8 3.582031-8 8s3.582031 8 8 8h16c4.417969 0 8-3.582031 8-8zm0 0" fill="url(#g)"/><path d="m408 400h-16c-4.417969 0-8 3.582031-8 8s3.582031 8 8 8h16c4.417969 0 8-3.582031 8-8s-3.582031-8-8-8zm0 0" fill="url(#h)"/></svg>
        
            Ти победи Кибер-чукундура! Жени-пръскачката е спасена. Вече си Бял Хакер!
            <br>
            <br>
            <a class="facebook" :href="`https://www.facebook.com/sharer/sharer.php?u=${$root.BASE_URL}`" target="_blank">
              <svg class="social-icon-share" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" enable-background="new 0 0 50 50"><path d="M30.3 13.7L25 8.4l-5.3 5.3-1.4-1.4L25 5.6l6.7 6.7z"/><path d="M24 7h2v21h-2z"/><path d="M35 40H15c-1.7 0-3-1.3-3-3V19c0-1.7 1.3-3 3-3h7v2h-7c-.6 0-1 .4-1 1v18c0 .6.4 1 1 1h20c.6 0 1-.4 1-1V19c0-.6-.4-1-1-1h-7v-2h7c1.7 0 3 1.3 3 3v18c0 1.7-1.3 3-3 3z"/></svg>
              Сподели новината във Facebook. Бързо!
            </a>
            <br>
            <br>
            <a class="facebook" href="https://fb.me/cyberge6" target="_blank">
              <svg class="social-icon-like" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 1000 1000" enable-background="new 0 0 1000 1000" xml:space="preserve"><g><path d="M730.8,981h-615C59.4,981,10,932,10,876.2V475.3c0-75.1,79.5-75.1,105.6-75.1l1.9,0.1c0.6,0,57.4,3.4,110.7,3.4c20.5,0,37.8-0.5,51.5-1.4c50.8-3.5,157.2-82.3,192.4-172.6c11.3-29,14.4-62.1,17.1-91.3C493.8,88,500.2,19,571.9,19c1.8,0,3.8,0.1,5.7,0.2C628,21.9,666.8,38.3,692.9,68c50.7,57.5,44.1,149.6,37.1,247.1c-2,27.9-4.1,56.5-4.7,84.2c14.1-0.3,28.9-0.4,44.4-0.4c44.3,0,79.9,1.1,87,1.3c2-0.1,3.9-0.1,5.8-0.1c75.1,0,125.1,56.5,127.4,143.8c2.2,84.1-69.2,294.8-158,386.1C799,963.8,765,981,730.8,981z M114.7,465.3c-32,0.1-38.3,4.7-39.2,5.7c0,0.1-0.4,1.5-0.4,4.3v400.9c0,18.4,17.8,39.7,40.7,39.7h615c19.9,0,40.6-17,54.5-31.3c79.2-81.3,141.3-274.6,139.6-339c-0.8-30.9-10.8-82.9-66.6-80.4l-1.3,0.1l-1.3,0c-0.4,0-38.5-1.3-85.9-1.3c-27.8,0-53.2,0.4-75.7,1.3l-32.9,1.3l-0.9-32.9c-1.1-40.7,1.9-82.7,4.8-123.2c6-83.5,11.7-162.4-21-199.4c-14.4-16.3-37.3-25.1-70-26.9c-9.6-0.5-14.4-2.4-20.1,60.2c-2.9,31.8-6.6,71.4-21.2,109c-43.7,111.9-171.7,208.5-248.5,213.9c-15.2,1.1-34.1,1.6-56.1,1.6C176.2,468.7,122.9,465.8,114.7,465.3z"/><path d="M285.9,434.4l3,496.3l-72.9,0.4l-3-496.3L285.9,434.4L285.9,434.4z"/></g></svg>
              Харесай нашата страничка. Нямаш време!
            </a>
          </div>
          <div v-else>
            <h2>Ужас!</h2>
            <svg class="end-info-dead" version="1.1" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32">
              <path d="M31.467 0h-3.733c-0.293 0-0.533 0.24-0.533 0.533 0 0.887-0.713 1.6-1.6 1.6s-1.6-0.713-1.6-1.6c0-0.293-0.24-0.533-0.533-0.533h-2.133c-0.293 0-0.533 0.24-0.533 0.533 0 0.887-0.713 1.6-1.6 1.6s-1.6-0.713-1.6-1.6c0-0.293-0.24-0.533-0.533-0.533h-2.133c-0.293 0-0.533 0.24-0.533 0.533 0 0.887-0.713 1.6-1.6 1.6s-1.6-0.713-1.6-1.6c0-0.293-0.24-0.533-0.533-0.533h-2.133c-0.293 0-0.533 0.24-0.533 0.533 0 0.887-0.713 1.6-1.6 1.6s-1.6-0.713-1.6-1.6c0-0.293-0.24-0.533-0.533-0.533h-3.733c-0.293 0-0.533 0.24-0.533 0.533v3.733c0 0.293 0.24 0.533 0.533 0.533 0.887 0 1.6 0.713 1.6 1.6s-0.713 1.6-1.6 1.6c-0.293 0-0.533 0.24-0.533 0.533v2.133c0 0.293 0.24 0.533 0.533 0.533 0.887 0 1.6 0.713 1.6 1.6s-0.713 1.6-1.6 1.6c-0.293 0-0.533 0.24-0.533 0.533v2.133c0 0.293 0.24 0.533 0.533 0.533 0.887 0 1.6 0.713 1.6 1.6s-0.713 1.6-1.6 1.6c-0.293 0-0.533 0.24-0.533 0.533v2.133c0 0.293 0.24 0.533 0.533 0.533 0.887 0 1.6 0.713 1.6 1.6s-0.713 1.6-1.6 1.6c-0.293 0-0.533 0.24-0.533 0.533v3.733c0 0.293 0.24 0.533 0.533 0.533h3.733c0.293 0 0.533-0.24 0.533-0.533 0-0.887 0.713-1.6 1.6-1.6s1.6 0.713 1.6 1.6c0 0.293 0.24 0.533 0.533 0.533h2.133c0.293 0 0.533-0.24 0.533-0.533 0-0.887 0.713-1.6 1.6-1.6s1.6 0.713 1.6 1.6c0 0.293 0.24 0.533 0.533 0.533h2.133c0.293 0 0.533-0.24 0.533-0.533 0-0.887 0.713-1.6 1.6-1.6s1.6 0.713 1.6 1.6c0 0.293 0.24 0.533 0.533 0.533h2.133c0.293 0 0.533-0.24 0.533-0.533 0-0.887 0.713-1.6 1.6-1.6s1.6 0.713 1.6 1.6c0 0.293 0.24 0.533 0.533 0.533h3.733c0.293 0 0.533-0.24 0.533-0.533v-3.733c0-0.293-0.24-0.533-0.533-0.533-0.887 0-1.6-0.713-1.6-1.6s0.713-1.6 1.6-1.6c0.293 0 0.533-0.24 0.533-0.533v-2.133c0-0.293-0.24-0.533-0.533-0.533-0.887 0-1.6-0.713-1.6-1.6s0.713-1.6 1.6-1.6c0.293 0 0.533-0.24 0.533-0.533v-2.133c0-0.293-0.24-0.533-0.533-0.533-0.887 0-1.6-0.713-1.6-1.6s0.713-1.6 1.6-1.6c0.293 0 0.533-0.24 0.533-0.533v-2.133c0-0.293-0.24-0.533-0.533-0.533-0.887 0-1.6-0.713-1.6-1.6s0.713-1.6 1.6-1.6c0.293 0 0.533-0.24 0.533-0.533v-3.733c0-0.293-0.24-0.533-0.533-0.533zM30.933 3.787c-1.24 0.253-2.133 1.347-2.133 2.613s0.893 2.36 2.133 2.613v1.173c-1.24 0.253-2.133 1.347-2.133 2.613s0.893 2.36 2.133 2.613v1.173c-1.24 0.253-2.133 1.347-2.133 2.613s0.893 2.36 2.133 2.613v1.173c-1.24 0.253-2.133 1.347-2.133 2.613s0.893 2.36 2.133 2.613v2.72h-2.72c-0.253-1.24-1.347-2.133-2.613-2.133s-2.36 0.893-2.613 2.133h-1.173c-0.253-1.24-1.347-2.133-2.613-2.133s-2.36 0.893-2.613 2.133h-1.173c-0.253-1.24-1.347-2.133-2.613-2.133s-2.36 0.893-2.613 2.133h-1.173c-0.253-1.24-1.347-2.133-2.613-2.133s-2.36 0.893-2.613 2.133h-2.72v-2.72c1.24-0.253 2.133-1.347 2.133-2.613s-0.893-2.36-2.133-2.613v-1.173c1.24-0.253 2.133-1.347 2.133-2.613s-0.893-2.36-2.133-2.613v-1.173c1.24-0.253 2.133-1.347 2.133-2.613s-0.893-2.36-2.133-2.613v-1.173c1.24-0.253 2.133-1.347 2.133-2.613s-0.893-2.36-2.133-2.613v-2.72h2.72c0.253 1.24 1.347 2.133 2.613 2.133s2.36-0.893 2.613-2.133h1.173c0.253 1.24 1.347 2.133 2.613 2.133s2.36-0.893 2.613-2.133h1.173c0.253 1.24 1.347 2.133 2.613 2.133s2.36-0.893 2.613-2.133h1.173c0.253 1.24 1.347 2.133 2.613 2.133s2.36-0.893 2.613-2.133h2.72v2.72z"></path>
              <path d="M16 5.333c-5.893 0-10.667 4.773-10.667 10.667s4.773 10.667 10.667 10.667 10.667-4.773 10.667-10.667c-0.007-5.887-4.78-10.66-10.667-10.667zM16 25.6c-5.3 0-9.6-4.3-9.6-9.6s4.3-9.6 9.6-9.6 9.6 4.3 9.6 9.6c-0.007 5.3-4.3 9.593-9.6 9.6z"></path>
              <path d="M9.553 22.4c0.14 0.013 0.28-0.027 0.387-0.12s0.18-0.22 0.187-0.36c0.020-0.227 0.553-5.387 5.867-5.387 5.3 0 5.847 5.16 5.867 5.38 0.027 0.293 0.287 0.513 0.58 0.487s0.513-0.287 0.487-0.58c-0.007-0.067-0.653-6.353-6.933-6.353s-6.927 6.287-6.933 6.353c-0.013 0.14 0.033 0.28 0.12 0.393 0.1 0.1 0.233 0.173 0.373 0.187z"></path>
              <path d="M13.333 15.467c1.18 0 2.133-0.953 2.133-2.133s-0.953-2.133-2.133-2.133-2.133 0.953-2.133 2.133 0.953 2.133 2.133 2.133zM13.333 12.267c0.587 0 1.067 0.48 1.067 1.067s-0.48 1.067-1.067 1.067-1.067-0.48-1.067-1.067 0.48-1.067 1.067-1.067z"></path>
              <path d="M18.667 15.467c1.18 0 2.133-0.953 2.133-2.133s-0.953-2.133-2.133-2.133-2.133 0.953-2.133 2.133 0.953 2.133 2.133 2.133zM18.667 12.267c0.587 0 1.067 0.48 1.067 1.067s-0.48 1.067-1.067 1.067-1.067-0.48-1.067-1.067 0.48-1.067 1.067-1.067z"></path>
              <path d="M6.4 5.333c0.293 0 0.533-0.24 0.533-0.533s-0.24-0.533-0.533-0.533h-1.067c-0.293 0-0.533 0.24-0.533 0.533s0.24 0.533 0.533 0.533h1.067z"></path>
              <path d="M6.4 6.933c0 0.293 0.24 0.533 0.533 0.533h0.533c0.293 0 0.533-0.24 0.533-0.533s-0.24-0.533-0.533-0.533h-0.533c-0.293 0-0.533 0.24-0.533 0.533z"></path>
              <path d="M26.133 25.067c0-0.293-0.24-0.533-0.533-0.533h-1.067c-0.293 0-0.533 0.24-0.533 0.533s0.24 0.533 0.533 0.533h1.067c0.293 0 0.533-0.24 0.533-0.533z"></path>
              <path d="M27.2 26.667h-1.067c-0.293 0-0.533 0.24-0.533 0.533s0.24 0.533 0.533 0.533h1.067c0.293 0 0.533-0.24 0.533-0.533s-0.24-0.533-0.533-0.533z"></path>
            </svg>
            Стана мазало. Вземи се в ръце и малко по-сериозно, защото НЯМА ВРЕМЕ!
          </div>
        </div>
      </div>
    </vue100vh>
  </div>
</template>

<script>
   
const countdown = 45; //seconds
const numOfSteps = 128;
const nonCompatible = 'Ем... Играта изисква жироскоп. Да се мандахерца - такова. Пробвай с някой таблет или мобилен телефон. Побързай! Жени-пръскачката няма да се справи без теб.';

const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(
  navigator.userAgent
);
const deviceEventStartType = isMobile ? "touchstart" : "mousedown",
  deviceEventEndType = isMobile ? "touchend" : "mouseup",
  constraints = { video: { facingMode: "environment" }, audio: false };

import { Howl, Howler } from "howler";

import vue100vh from "vue-100vh";

import CyberGe6 from "@/components/CyberGe6.vue";
import { setInterval, setTimeout, clearInterval } from "timers";

var _self;

export default {
  name: "app",
  components: {
    vue100vh,
    CyberGe6
  },
  data() {
    return {
      appStarted: false,
      appEnded: false,
      isWinner: false,
      countdown,
      countdownInterval: null,
      cameraExists: true,
      lsdActive: false,
      sound: null,
      fire: false,
      fireInterval: null,
      left: 0,
      top: 0,
      angle: 0,
      step: 1,
      deviceOrientationData: { alpha: 0, beta: 0, gamma: 0 }, //init with 0 as defaults
      offsetOrientationData: { top: 0, left: 0, angle: 0 },
      stats: { total: 0, survived: 0, killed: 0 },
    };
  },
  watch: {
    appStarted(val){
      if(val){
        _self.$nextTick(() => {
          _self.attachBtns();
          _self.$refs.btnLSD.addEventListener(
            deviceEventStartType,
            function() {
              _self.lsdActive = !_self.lsdActive;
              if(_self.lsdActive)
                _self.cameraStart();
              else{
                _self.cameraStop();
              }
            },
            false
          );
        });
        self.countdown = countdown;
        _self.countdownInterval = setInterval(()=>{
          _self.countdown--;
          if(_self.countdown <= 10){
            _self.$refs.countdown.classList.add('red');
          }
          if(_self.countdown <= 0){
            _self.onEnd();
          }
        }, 1000)
      }
      else{
        clearInterval(_self.countdownInterval);
      }
    }
  },
  methods: {
    onStats(stats) {
      this.stats = stats;
    },
    onFireEvent(state) {
      _self.$root.sound.laser.play();
      _self.fire = state;
      if(state){
        _self.$refs.laser.classList.add('active');
        _self.$refs.laser.style.borderTopColor = _self.getRainbow();
      }
      else{
        _self.$refs.laser.classList.remove('active');
      }
    },
    onEnd(){
      _self.isWinner = _self.stats.killed > _self.stats.survived;
      _self.$refs.countdown.classList.remove('red');
      _self.countdown = countdown;
      _self.appStarted = false;
      _self.appEnded = true;
      this.$root.sound.talks.stop();
      if(_self.isWinner)
        this.$root.sound.talks.play('win');
      else
        this.$root.sound.talks.play('lose');
    },
    onBegin(){
      if(!_self.appEnded){
        _self.$root.sound = {
          laser: new Howl({
            src: ["sounds/laser.mp3"]
          }),
        survived: new Howl({
          src: ["sounds/survived.mp3"],
          volume: 0.1,
        }),
        talks: new Howl({
          src: ["sounds/ge6_mixdown.mp3"],
          sprite: this.$root.talks
        }),
        background: new Howl({
          src: ["sounds/background.mp3"],
          autoplay: true,
          loop: true,
          volume: 0.2,
        })
        }
      }
      if(isMobile)
          _self.appStarted = true;
        else{
          _self.$refs.txtInfo.innerText = nonCompatible;
        }
    },
    attachBtns() {
      _self.$refs.btnFire.addEventListener(
        deviceEventStartType,
        function() {
          if (_self.fireInterval) _self.fireInterval.close();

          _self.onFireEvent(true);
          _self.fireInterval = setInterval(() => {
            _self.onFireEvent(true);
          }, 200);
        },
        false
      );

      _self.$refs.btnFire.addEventListener(
        deviceEventEndType,
        function() {
          if (_self.fireInterval) _self.fireInterval.close();
          _self.fireInterval = null;
          _self.onFireEvent(false);
        },
        false
      );
    },
    //TODO
    //check device orientation portrait/landscape and recalculate accordingly..
    processGyro(alpha, beta, gamma) {

      _self.deviceOrientationData.alpha = alpha;
      _self.deviceOrientationData.beta = beta;
      _self.deviceOrientationData.gamma = gamma;

      var coords = _self.rotatePointViaGyroEulars([1, 1, 1]);

      var leftPercent = ((coords[0] * 100) / 180) * 100;
      var topPercent = ((coords[1] * 100) / 180) * 100;

      var left = (window.innerWidth * leftPercent) / 100,
        top = (window.innerHeight * topPercent) / 100,
        angle = coords[2] * 100 + 180;

      if (
        !_self.offsetOrientationData.top &&
        !_self.offsetOrientationData.left &&
        !_self.offsetOrientationData.angle
      ) {
        _self.offsetOrientationData.top = top;
        _self.offsetOrientationData.left = left;
        _self.offsetOrientationData.angle = angle;
      }

      _self.left =
        _self.offsetOrientationData.left > 0
          ? left - _self.offsetOrientationData.left
          : left + _self.offsetOrientationData.left * -1;
      _self.top =
        _self.offsetOrientationData.top > 0
          ? top - _self.offsetOrientationData.top
          : top + _self.offsetOrientationData.top * -1;
      _self.angle =
        _self.offsetOrientationData.angle > 0
          ? angle - _self.offsetOrientationData.angle
          : angle + _self.offsetOrientationData.angle * -1;
    },
    degToRad(deg) {
      return (deg * Math.PI) / 180;
    },
    rotatePointViaGyroEulars(ra) {
      var oldX = ra[0];
      var oldY = ra[1];
      var oldZ = ra[2];

      //order here is important - it must match the processing order of the device

      //rotate about z axis
      var newX =
        oldX * Math.cos(-_self.degToRad(_self.deviceOrientationData.alpha)) -
        oldY * Math.sin(-_self.degToRad(_self.deviceOrientationData.alpha));
      var newY =
        oldY * Math.cos(-_self.degToRad(_self.deviceOrientationData.alpha)) +
        oldX * Math.sin(-_self.degToRad(_self.deviceOrientationData.alpha));

      //rotate about x axis
      oldY = newY;
      newY =
        oldY * Math.cos(-_self.degToRad(_self.deviceOrientationData.beta)) -
        oldZ * Math.sin(-_self.degToRad(_self.deviceOrientationData.beta));
      var newZ =
        oldZ * Math.cos(-_self.degToRad(_self.deviceOrientationData.beta)) +
        oldY * Math.sin(-_self.degToRad(_self.deviceOrientationData.beta));

      //rotate about y axis
      oldZ = newZ;
      oldX = newX;

      newZ =
        oldZ * Math.cos(-_self.degToRad(_self.deviceOrientationData.gamma)) -
        oldX * Math.sin(-_self.degToRad(_self.deviceOrientationData.gamma));
      newX =
        oldX * Math.cos(-_self.degToRad(_self.deviceOrientationData.gamma)) +
        oldZ * Math.sin(-_self.degToRad(_self.deviceOrientationData.gamma));

      return [newX, newY, newZ];
    },
    getRainbow() {
      this.step++;
      // This function generates vibrant, "evenly spaced" colours (i.e. no clustering). This is ideal for creating easily distinguishable vibrant markers in Google Maps and other apps.
      // Adam Cole, 2011-Sept-14
      // HSV to RBG adapted from: http://mjijackson.com/2008/02/rgb-to-hsl-and-rgb-to-hsv-color-model-conversion-algorithms-in-javascript
      var r, g, b;
      var h = this.step / numOfSteps;
      var i = ~~(h * 6);
      var f = h * 6 - i;
      var q = 1 - f;

      if(this.step >= numOfSteps){
        this.step = 1;
      }

      switch(i % 6){
          case 0: r = 1; g = f; b = 0; break;
          case 1: r = q; g = 1; b = 0; break;
          case 2: r = 0; g = 1; b = f; break;
          case 3: r = 0; g = q; b = 1; break;
          case 4: r = f; g = 0; b = 1; break;
          case 5: r = 1; g = 0; b = q; break;
      }
      var c = "#" + ("00" + (~ ~(r * 255)).toString(16)).slice(-2) + ("00" + (~ ~(g * 255)).toString(16)).slice(-2) + ("00" + (~ ~(b * 255)).toString(16)).slice(-2);
      return (c);
    },
    renderLoop() {
      requestAnimationFrame(_self.renderLoop);
      if (!(window.DeviceOrientationEvent && "ontouchstart" in window)) {
        this.fakeAlpha = (this.fakeAlpha || 0) + 0.0; //z axis - use 0 to turn off rotation
        this.fakeBeta = (this.fakeBeta || 0) + 0.7; //x axis
        this.fakeGamma = (this.fakeGamma || 0) + 0.5; //y axis
        _self.processGyro(this.fakeAlpha, this.fakeBeta, this.fakeGamma);
      }
    },
    cameraStart() {
      navigator.mediaDevices
        .getUserMedia(constraints)
        .then(function(stream) {
          _self.$refs.camera.srcObject = stream;
        })
        .catch(function(error) {
          _self.cameraExists = false;
        });
    }
  },
  mounted() {
    _self = this;
    if (window.DeviceOrientationEvent) {
      window.addEventListener(
        "deviceorientation",
        event => {
          _self.processGyro(event.alpha, event.beta, event.gamma);
        },
        true
      );
    }
    if (!isMobile) {
      _self.renderLoop();
    }

    document.addEventListener(
      "touchmove",
      function(event) {
        if (event.scale !== 1) {
          event.preventDefault();
        }
      },
      { passive: false }
    );
  }
};
</script>

<style>
#app {
  font-family: "Avenir", Helvetica, Arial, sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  text-align: center;
  color: #2c3e50;
  height: 100%;
  width: 100%;
}

#camera {
  position: absolute;
  height: 100%;
  width: 100%;
  top: 0;
  left: 0;
  object-fit: cover;
}
#info {
  position: absolute;
  top: 0;
  left: 0;
  height: calc(100% - 100px);
  width: calc(100% - 100px);
  padding: 50px;
  color: #fff;
  background: rgba(0, 0, 0, 0.4);
  text-shadow: 2px 2px 2px #000;
}
.logo{
  width: 120px;
  margin-top: -20px;
  margin-right: -50px;
}
.info-logo {
  width: 150px;
  margin: 0 auto;
  display: block;
  padding-bottom: 40px;
}
.clock{
  font-size: 3em
}
@media only screen and (max-width: 725px) {
  #info{
    padding: 10px;
    height: calc(100% - 20px);
    width: calc(100% - 20px);
  }
  .info-logo {
    width: 50px;
    padding-bottom: 10px;
  }
}
.laser{
  width: 10px;
  position: absolute;
  bottom: 100px;
  left: 50%;
  margin-left: -10px;
  border-top-style: solid;
  border-left-style: solid;
  border-right-style: solid;
  border-top-color:orange;
  transition: border-top-color .1s;
  border-left-color:transparent;
  border-right-color:transparent;

  opacity: 0;
  border-top-width: 0px;
  border-left-width: 5px;
  border-left-width: 5px;
  border-radius: 10px;
}
.laser.active {
  animation: laser .2s infinite;
}
@keyframes laser {
  0%   {
    opacity: 1;
    border-left-width: 5px;
    border-left-width: 5px;
    border-top-width: 0;
  }
  50%  {
    border-top-width: 200px;
    margin-left: 0px;
    /* opacity: ; */
  }
  100% {
    border-left-width: 0;
    border-left-width: 0;
    opacity: 0;
  }
}
.itcard {
  width: 100px;
  height: 100px;
  position: absolute;
  margin-left: -50px;
  left: 50%;
  bottom: 50px;
  pointer-events: all;
  background: none;
  border: none;
  -ms-touch-action: manipulation;
  touch-action: manipulation;
}
.itcard img {
  width: 100%;
  height: 100%;
  pointer-events: none;
  touch-action: manipulation;
  object-fit: contain;
}
.lsd{
  width: 50px;
  height: 50px;
  position: absolute;
  margin-left: -25px;
  left: 50%;
  top: 20px;
  pointer-events: all;
  background: none;
  border: none;
  -ms-touch-action: manipulation;
  touch-action: manipulation;
}
.lsd svg {
  width: 100%;
  height: 100%;
  pointer-events: none;
  touch-action: manipulation;
  object-fit: contain;
}
.inobounce {
  overflow: auto;
  -webkit-overflow-scrolling: touch;
}
.border {
  position: absolute;
  height: 100px;
  width: 100vh;
  background-image: url(./assets/border.png);
}
.border.left {
  -webkit-transform: rotate(90deg);
  -moz-transform: rotate(90deg);
  -ms-transform: rotate(90deg);
  -o-transform: rotate(90deg);
  transform: rotate(90deg);
  width: 100vh;
  top: calc(50vh + -50px);
  left: calc(-50vh + 50px);
}
.border.top {
  -webkit-transform: rotate(180deg);
  -moz-transform: rotate(180deg);
  -ms-transform: rotate(180deg);
  -o-transform: rotate(180deg);
  transform: rotate(180deg);
  width: 100vw;
}
.border.right {
  -webkit-transform: rotate(270deg);
  -moz-transform: rotate(270deg);
  -ms-transform: rotate(270deg);
  -o-transform: rotate(270deg);
  transform: rotate(270deg);
  width: 100vh;
  top: calc(50vh + -50px);
  right: calc(-50vh + 50px);
}
.border.bottom {
  bottom: 0;
  width: 100vw;
}
.console {
  width: 100%;
  height: 80px;
  background: rgba(0, 0, 0, 0.7);
  position: absolute;
  left: 0;
  bottom: 0;
  color: #fff;
  text-align: left;
  padding-left: 20px;
  padding-top: 20px;
}
#crosshair {
  width: 50px;
  height: 50px;
  margin-left: -25px;
  margin-top: -25px;
  position: absolute;
  top: 50%;
  left: 50%;
  opacity: 0.7;
}
#crosshair svg {
  fill: #fff;
  -webkit-filter: drop-shadow(0px 0px 3px rgba(0, 0, 0, 0.7));
  filter: drop-shadow(0px 0px 3px rgba(0, 0, 0, 0.7));
}
.console .left {
  width: fit-content;
  position: absolute;
}
.console .right {
  width: fit-content;
  position: absolute;
  right: 40px;
}
.facebook{
  pointer-events: all;
  color:#fff;
  text-decoration: none;
  font-weight: bold;
}
.green{
  color: green;
}
.red {
  color: red;
}
.end-info{
  display: block;
  width: 40px;
  height: 40px;
  margin: 0 auto;
  padding-bottom: 20px;
  filter: brightness(2);
}
.end-info-dead{
  display: block;
  width: 140px;
  height: 140px;
  margin: 0 auto;
  padding-bottom: 20px;
  fill: red;
}
.social-icon-share{
  width:50px;
  height:50px;
  margin-top:-15px;
  margin-left: -50px;
  fill:#fff;
  position:absolute;
}
.social-icon-like{
  width:30px;
  height:30px;
  margin-top:-5px;
  margin-left: -40px;
  fill:#fff;
  position:absolute;
}
</style>
